<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <title>独家号 - 分享平台</title>
    <head th:include="head:: head"></head>
    <script>
        $(function(){

            $("a[id^='favorite-button-']").on("click", function(event){
                event.preventDefault();//使a自带的方法失效，即无法调整到href中的URL
                var $this = $(this);
                var url = $this.attr("href");
                var method = $this.attr("action");
                if(method == 'post'){
                    $.post(url,{action : 1},function(data){
                        if(data.status == "success"){
                            $this.addClass("btn-info");
                            $this.attr("action", "delete");
                            $this.text("已订阅");
                            $("#sub").text(
                                parseInt($("#sub").text())+1);
                        }
                    });
                }
                else{
                    $.post(url,{action : -1},function(data){
                        if(data.status == "success"){
                            $this.removeClass("btn-info");
                            $this.attr("action", "post");
                            $this.text("订阅");
                            $("#sub").text(
                                parseInt($("#sub").text())-1);
                        }
                    });
                }
            });
        });
    </script>
</head>

<body>
<div th:include="header:: header" role="navigation" class="zu-top nav-style" data-za-module="TopNavBar"></div>
<br/>
<br/>
<div id="main" style="margin-top: 20px;">
    <div class="container">
        <div class="user-info2 text-center">
            <img width="96" class="img-circle" th:src="@{/img/moon-220x150.png}" alt=""/>
            <h3 th:text="${exclusive.publicName}"></h3>

            <p>
                <a th:href="@{'/u'+${exclusive.user.id}+'/home'}" th:text="${exclusive.user.nickName}"></a>
                创建
            </p>

            <!--独家号为非当前用户时才显示-->
            <!-- isSub表示是否订阅 -->
            <a th:if="${{@viewUtils.getCurrentUser().getId()}} != ${exclusive.user.id}" th:id="@{'favorite-button-'+${exclusive.user.id}}" th:class="@{${isSub}?'btn btn-default btn-sm btn-info':'btn btn-default btn-sm'}" th:action="@{${isSub}?'delete':'post'}" th:href="@{'/favorites/exclusive/e'+${exclusive.id}}"  th:text="${isSub}?'已订阅':'订阅'">
                <i class="fa fa-rss"></i>
            </a>
            <!--独家号为当前用户时才显示-->

        </div>
    </div>
    <div class="container">
        <ul class="user_atten clearfix W_f18 center">
            <li class="S_line1"><a bpfilter="page_frame" href="/5580413350/profile?rightmod=1&amp;wvr=6&amp;mod=personnumber" class="S_txt1"><strong node-type="weibo" th:text="${exclusive.share}">0</strong><span class="S_txt2">分享</span></a></li>
            <li class="S_line1"><a bpfilter="page_frame" href="/5580413350/profile?rightmod=1&amp;wvr=6&amp;mod=personnumber" class="S_txt1"><strong id="sub" node-type="weibo" th:text="${exclusive.subscriber}">0</strong><span class="S_txt2">订阅</span></a></li>
        </ul>
    </div>
    <br/>
</div>
</body>

</html>
